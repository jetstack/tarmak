[Unit]
Description=Vault unsealer service
Requires=vault-assets.service
After=vault-assets.service

[Service]
Restart=always
RestartSec=5
Environment=AWS_REGION=<%= @region %>
Environment=VAULT_CACERT=/etc/vault/tls/ca.pem
Environment=VAULT_ADDR=https://localhost:8200
Environment=VAULT_UNSEALER_MODE=aws-kms-ssm
Environment=VAULT_UNSEALER_AWS_KMS_KEY_ID=<%= @vault_unsealer_kms_key_id %>
Environment=VAULT_UNSEALER_AWS_SSM_KEY_PREFIX=<%= @vault_unsealer_ssm_key_prefix %>
Environment=VAULT_UNSEALER_STORE_ROOT_TOKEN=false
ExecStart=/opt/bin/vault-unsealer unseal

[Install]
WantedBy=multi-user.target
